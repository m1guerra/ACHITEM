[
  ACH.LOOKUP
]


TARGET=ACCOUNT

DEFINE
  STARTDATE = DATE
  ENDDATE = DATE
  TEMPCOUNT = NUMBER
  TEMPLASTDATE = DATE
END

SETUP
  STARTDATE = DATEREAD("Enter Start Date")
  ENDDATE = DATEREAD("Enter End Date")
END

PRINT TITLE="ACH ITEMS"
    HEADERS 
        COL=001 "ACCOUNT#"
        COL=030 "NAME"
        COL=060 "MEMBER GROUP"
        COL=080 "LAST DIRECT DEPOSIT"
        NEWLINE
        COL=001 REPEATCHR("-",132)
        NEWLINE
    END [HEADERS]

    TEMPCOUNT = 0
    TEMPLASTDATE = '--/--/--'
    LASTDATE = '--/--/--'

    CALL ACHITEMPROC

    IF TEMPCOUNT > 0 THEN
    DO
      COL = 001 ACCOUNT:NUMBER
      COL = 030 NAME:SHORTNAME
      COL = 060 ACCOUNT:MEMBERGROUP
      COL = 080 LASTDATE
      NEWLINE
    END
END 

PROCEDURE ACHITEMPROC
  FOR ACHITEM WITH ACCOUNT ACCOUNT:NUMBER
   DO
    IF (ACHITEM:COMPANYID = ""
        OR ACHITEM:COMPANYID = "" ) THEN 
     DO
      IF (ACHITEM:TRANPOSTDATE >= STARTDATE
          AND ACHITEM:TRANPOSTDATE <= ENDDATE) THEN
       DO
        TEMPCOUNT = TEMPCOUNT + 1
        TEMPLASTDATE = ACHITEM:TRANPOSTDATE
        
        IF TEMPLASTDATE > LASTDATE THEN
        DO
          LASTDATE = ACHITEM:TRANPOSTDATE
        END
       END
     END
   END
END [ACHITEM]
